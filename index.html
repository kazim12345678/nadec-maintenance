<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NADEC – Maintenance KPI Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --primary: #006f3c;
      --primary-light: #e5f4ec;
      --accent: #0099cc;
      --bg: #f5f7fa;
      --card-bg: #ffffff;
      --text-main: #222;
      --text-muted: #666;
      --border: #d0d4dd;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text-main);
    }
    header {
      background: var(--primary);
      color: #fff;
      padding: 16px 24px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
    }
    header h1 {
      margin: 0;
      font-size: 1.4rem;
    }
    header span {
      font-size: 0.9rem;
      opacity: 0.9;
    }
    main {
      max-width: 1200px;
      margin: 16px auto 40px;
      padding: 0 16px;
    }
    h2 {
      margin: 24px 0 8px;
      font-size: 1.2rem;
      color: var(--primary);
    }
    h3 {
      margin: 16px 0 8px;
      font-size: 1rem;
      color: var(--text-main);
    }
    .section-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 24px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.04);
      border: 1px solid var(--border);
    }
    .note {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 8px;
    }
    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
      margin-top: 8px;
    }
    .kpi-card {
      background: var(--primary-light);
      border-radius: 8px;
      padding: 12px;
      border: 1px solid var(--primary);
    }
    .kpi-label {
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }
    .kpi-value {
      font-size: 1.3rem;
      font-weight: 600;
      margin-top: 4px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 0.85rem;
    }
    th, td {
      border: 1px solid var(--border);
      padding: 6px 8px;
      text-align: left;
      vertical-align: top;
    }
    th {
      background: #f0f3f8;
      font-weight: 600;
    }
    tbody tr:nth-child(even) {
      background: #fafbfe;
    }
    .pill {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid var(--border);
      background: #fff;
      margin: 2px 4px 2px 0;
    }
    .layout-two {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1.5fr);
      gap: 16px;
    }
    @media (max-width: 800px) {
      .layout-two {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>NADEC – Maintenance KPI Dashboard</h1>
      <span>Maintenance Department – Haradh Plant | Lines 1–18 (Filler, Labeller, Packer, Palletizer)</span>
    </div>
    <div>
      <span>Source: Maintenance RAW_DATA &amp; PM_SCHEDULE</span>
    </div>
  </header>

  <main>
    <!-- DASHBOARD SUMMARY -->
    <section class="section-card">
      <h2>Plant KPI Overview</h2>
      <p class="note">High-level KPIs summarizing breakdown, PM performance, and cost impact.</p>
      <div class="kpi-grid">
        <div class="kpi-card">
          <div class="kpi-label">Total Breakdown Hours</div>
          <div class="kpi-value">—</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">PM Completion %</div>
          <div class="kpi-value">—</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Plant MTTR (hrs)</div>
          <div class="kpi-value">—</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Plant MTBF (hrs)</div>
          <div class="kpi-value">—</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Maintenance Cost (SAR)</div>
          <div class="kpi-value">—</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Power Cost (SAR)</div>
          <div class="kpi-value">—</div>
        </div>
      </div>
    </section>

    <!-- RAW_DATA -->
    <section class="section-card">
      <h2>RAW_DATA – Maintenance Records</h2>
      <p class="note">Enter maintenance records here. Month &amp; Duration Bucket are auto-calculated in Excel version.</p>

      <h3>Maintenance Events</h3>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Month</th>
            <th>Line Number</th>
            <th>Machine Name</th>
            <th>Maintenance Type</th>
            <th>Breakdown Category</th>
            <th>Breakdown Cause</th>
            <th>Breakdown Duration (Hours)</th>
            <th>Repair Time (Hours)</th>
            <th>Technician Name</th>
            <th>Maintenance Cost (SAR)</th>
            <th>Power Consumption Cost (SAR)</th>
            <th>Status</th>
            <th>Duration Bucket</th>
          </tr>
        </thead>
        <tbody>
          <!-- Example rows – replace with real data if needed -->
          <tr>
            <td>2025-01-01</td>
            <td>Jan</td>
            <td>1</td>
            <td>Filler</td>
            <td>Preventive</td>
            <td>Mechanical</td>
            <td>Missing Parts</td>
            <td>2.5</td>
            <td>2.0</td>
            <td>Tech A</td>
            <td>1500</td>
            <td>300</td>
            <td>Completed</td>
            <td>0–3 hrs</td>
          </tr>
          <tr>
            <td>2025-01-02</td>
            <td>Jan</td>
            <td>2</td>
            <td>Labeller</td>
            <td>Breakdown</td>
            <td>Electrical</td>
            <td>Power Cut</td>
            <td>1.0</td>
            <td>0.8</td>
            <td>Tech B</td>
            <td>900</td>
            <td>120</td>
            <td>Pending</td>
            <td>0–3 hrs</td>
          </tr>
        </tbody>
      </table>

      <h3>Reference Lists</h3>
      <p class="note">Lists used as dropdowns / validation in the Excel file.</p>
      <div>
        <span class="pill">Line_Number_List: 1–18</span>
        <span class="pill">Machine_List: Filler, Labeller, Packer, Palletizer, Safety, Hygiene</span>
        <span class="pill">Maint_Type_List: Preventive, Breakdown, Instrumentation, Automation, Others</span>
        <span class="pill">Category_List: Mechanical, Electrical, Instrumentation, Automation, Manpower, Others</span>
        <span class="pill">Cause_List: Missing Parts, Power Cut, PM Planned, Manpower, Others</span>
        <span class="pill">Status_List: Completed, Pending, Not Completed</span>
      </div>
    </section>

    <!-- PM_SCHEDULE -->
    <section class="section-card">
      <h2>PM_SCHEDULE – Planned Maintenance</h2>
      <p class="note">Planned PM tasks with frequency, dates, and completion status.</p>

      <table>
        <thead>
          <tr>
            <th>Line Number</th>
            <th>Machine</th>
            <th>PM Task</th>
            <th>Frequency</th>
            <th>Planned Date</th>
            <th>Completed Date</th>
            <th>Status</th>
            <th>Assigned Technician</th>
            <th>Month</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>Filler</td>
            <td>Monthly PM</td>
            <td>Monthly</td>
            <td>2025-01-05</td>
            <td>2025-01-05</td>
            <td>Completed</td>
            <td>Tech A</td>
            <td>Jan</td>
          </tr>
          <tr>
            <td>2</td>
            <td>Labeller</td>
            <td>Weekly Check</td>
            <td>Weekly</td>
            <td>2025-01-07</td>
            <td></td>
            <td>Planned</td>
            <td>Tech B</td>
            <td>Jan</td>
          </tr>
        </tbody>
      </table>

      <h3>Frequency List</h3>
      <div>
        <span class="pill">Daily</span>
        <span class="pill">Weekly</span>
        <span class="pill">Monthly</span>
        <span class="pill">Quarterly</span>
        <span class="pill">Half-Yearly</span>
        <span class="pill">Yearly</span>
        <span class="pill">Running Hours</span>
      </div>
    </section>

    <!-- KPI_CALC -->
    <section class="section-card">
      <h2>KPI_CALC – Calculated KPIs</h2>
      <p class="note">In Excel, this sheet aggregates RAW_DATA &amp; PM_SCHEDULE into monthly and line-wise KPIs.</p>

      <div class="layout-two">
        <div>
          <h3>Monthly Breakdown Hours</h3>
          <table>
            <thead>
              <tr>
                <th>Month</th>
                <th>Total Breakdown Hours</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Jan</td><td>—</td></tr>
              <tr><td>Feb</td><td>—</td></tr>
              <tr><td>Mar</td><td>—</td></tr>
              <tr><td>Apr</td><td>—</td></tr>
              <tr><td>May</td><td>—</td></tr>
              <tr><td>Jun</td><td>—</td></tr>
              <tr><td>Jul</td><td>—</td></tr>
              <tr><td>Aug</td><td>—</td></tr>
              <tr><td>Sep</td><td>—</td></tr>
              <tr><td>Oct</td><td>—</td></tr>
              <tr><td>Nov</td><td>—</td></tr>
              <tr><td>Dec</td><td>—</td></tr>
            </tbody>
          </table>

          <h3>PM vs Breakdown Manhours (Monthly)</h3>
          <table>
            <thead>
              <tr>
                <th>Month</th>
                <th>PM Manhours</th>
                <th>Breakdown Manhours</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Jan</td><td>—</td><td>—</td></tr>
              <tr><td>Feb</td><td>—</td><td>—</td></tr>
              <tr><td>Mar</td><td>—</td><td>—</td></tr>
              <tr><td>Apr</td><td>—</td><td>—</td></tr>
              <tr><td>May</td><td>—</td><td>—</td></tr>
              <tr><td>Jun</td><td>—</td><td>—</td></tr>
              <tr><td>Jul</td><td>—</td><td>—</td></tr>
              <tr><td>Aug</td><td>—</td><td>—</td></tr>
              <tr><td>Sep</td><td>—</td><td>—</td></tr>
              <tr><td>Oct</td><td>—</td><td>—</td></tr>
              <tr><td>Nov</td><td>—</td><td>—</td></tr>
              <tr><td>Dec</td><td>—</td><td>—</td></tr>
            </tbody>
          </table>
        </div>

        <div>
          <h3>Breakdown Contribution by Line</h3>
          <table>
            <thead>
              <tr>
                <th>Line Number</th>
                <th>Breakdown Hours</th>
                <th>Contribution %</th>
              </tr>
            </thead>
            <tbody>
              <!-- Lines 1–18 -->
              <tr><td>1</td><td>—</td><td>—</td></tr>
              <tr><td>2</td><td>—</td><td>—</td></tr>
              <tr><td>3</td><td>—</td><td>—</td></tr>
              <tr><td>4</td><td>—</td><td>—</td></tr>
              <tr><td>5</td><td>—</td><td>—</td></tr>
              <tr><td>6</td><td>—</td><td>—</td></tr>
              <tr><td>7</td><td>—</td><td>—</td></tr>
              <tr><td>8</td><td>—</td><td>—</td></tr>
              <tr><td>9</td><td>—</td><td>—</td></tr>
              <tr><td>10</td><td>—</td><td>—</td></tr>
              <tr><td>11</td><td>—</td><td>—</td></tr>
              <tr><td>12</td><td>—</td><td>—</td></tr>
              <tr><td>13</td><td>—</td><td>—</td></tr>
              <tr><td>14</td><td>—</td><td>—</td></tr>
              <tr><td>15</td><td>—</td><td>—</td></tr>
              <tr><td>16</td><td>—</td><td>—</td></tr>
              <tr><td>17</td><td>—</td><td>—</td></tr>
              <tr><td>18</td><td>—</td><td>—</td></tr>
              <tr><td><strong>Total</strong></td><td>—</td><td>100%</td></tr>
            </tbody>
          </table>

          <h3>Cost vs Budget (Monthly)</h3>
          <table>
            <thead>
              <tr>
                <th>Month</th>
                <th>Maint Cost Actual</th>
                <th>Maint Cost Budget</th>
                <th>Power Cost Actual</th>
                <th>Power Cost Budget</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Jan</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Feb</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Mar</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Apr</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>May</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Jun</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Jul</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Aug</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Sep</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Oct</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Nov</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
              <tr><td>Dec</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <h3>Plant KPIs (Overall)</h3>
      <table>
        <tbody>
          <tr><th>Total Breakdown Hours</th><td>—</td></tr>
          <tr><th>Total Maintenance Cost</th><td>—</td></tr>
          <tr><th>Total Power Cost</th><td>—</td></tr>
          <tr><th>Overall PM Completion %</th><td>—</td></tr>
        </tbody>
      </table>
    </section>

    <!-- DASHBOARD DETAIL SECTIONS -->
    <section class="section-card">
      <h2>Dashboard Detail Sections</h2>
      <p class="note">These correspond to the charts and pivots you planned in Excel.</p>

      <h3>Downtime Causes</h3>
      <p class="note">In Excel: build Pivot &amp; Pie using RAW_DATA (Breakdown Category / Cause vs Duration).</p>

      <h3>Failure Status Trend</h3>
      <p class="note">In Excel: build Pivot &amp; Line using RAW_DATA (Status vs Month).</p>

      <h3>Breakdown Duration Status</h3>
      <p class="note">In Excel: build Pivot &amp; Chart using RAW_DATA (Duration Bucket vs Count / Hours).</p>

      <h3>PM Completion Summary</h3>
      <p class="note">Completed vs Not Completed PM tasks from PM_SCHEDULE.</p>
      <table>
        <thead>
          <tr>
            <th>Status</th>
            <th>Count</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Completed</td><td>—</td></tr>
          <tr><td>Not Completed</td><td>—</td></tr>
        </tbody>
      </table>
    </section>
  </main>
</body>
</html>
